# Requirements Specification

## 概要
企業のウェブサイトから問い合わせフォームを自動的に検出し、必要な情報を入力して送信することで、複数企業への問い合わせ業務を効率化するWebサービス。営業活動、市場調査、パートナー開拓などの業務で発生する大量の問い合わせ作業を自動化します。

## 要件

### 要件1: 企業URL管理機能
**ユーザーストーリー:** ユーザーとして、問い合わせを送信したい企業のURLリストを管理したい。これにより、複数の企業への問い合わせを一元管理できる。

#### 受け入れ条件
1. WHEN ユーザーが新しい企業URLを追加する THEN URLの妥当性が検証され、企業名と共に保存される
2. WHEN ユーザーが企業リストを表示する THEN 企業名、URL、最終送信日時、ステータスが一覧表示される
3. IF 無効なURLが入力された THEN エラーメッセージが表示され、保存されない
4. WHEN ユーザーが企業情報を編集する THEN 企業名、URL、メモなどの情報を更新できる
5. WHEN ユーザーが企業を削除する THEN 確認ダイアログの後、関連する送信履歴も含めて削除される

### 要件2: 問い合わせフォーム自動検出機能
**ユーザーストーリー:** ユーザーとして、企業のウェブサイトから問い合わせフォームを自動的に検出してもらいたい。これにより、手動でフォームを探す手間を省ける。

#### 受け入れ条件
1. WHEN システムが企業URLにアクセスする THEN 問い合わせ、お問い合わせ、Contact、お客様相談などのリンクを自動検出する
2. WHEN 問い合わせページが見つかった THEN フォームの入力フィールドを自動的に解析し、必須項目を識別する
3. IF 問い合わせフォームが見つからない THEN サイトマップやフッターリンクから再検索を試みる
4. WHEN 複数の問い合わせフォームが存在する THEN ユーザーに選択肢を提示する
5. IF JavaScriptで動的に生成されるフォームの場合 THEN ヘッドレスブラウザを使用して検出する

### 要件3: フォーム入力テンプレート管理機能
**ユーザーストーリー:** ユーザーとして、問い合わせ内容のテンプレートを作成・管理したい。これにより、用途に応じた適切な問い合わせ文を効率的に送信できる。

#### 受け入れ条件
1. WHEN ユーザーがテンプレートを作成する THEN 会社名、担当者名、メールアドレス、電話番号、問い合わせ内容などの項目を設定できる
2. WHEN ユーザーが変数を使用する THEN {{company_name}}、{{date}}などの動的な値を埋め込める
3. WHEN テンプレートを選択する THEN プレビュー機能で実際の入力内容を確認できる
4. IF 必須項目が空の場合 THEN 警告が表示され、送信前に入力を促される
5. WHEN 複数のテンプレートが存在する THEN カテゴリ分けして管理できる

### 要件4: 自動フォーム入力・送信機能
**ユーザーストーリー:** ユーザーとして、選択したテンプレートの内容でフォームを自動入力・送信してもらいたい。これにより、手動入力の時間と労力を大幅に削減できる。

#### 受け入れ条件
1. WHEN システムがフォームを検出する THEN 各入力フィールドとテンプレート項目を自動的にマッピングする
2. WHEN フォームに入力する THEN name属性、id属性、label要素などから適切なフィールドを特定する
3. IF reCAPTCHAやその他の認証が存在する THEN ユーザーに通知し、手動介入を促す
4. WHEN 送信ボタンをクリックする前 THEN 入力内容の最終確認画面を表示する（オプション）
5. IF 送信エラーが発生した THEN エラー内容を記録し、リトライオプションを提供する

### 要件5: 送信履歴・ステータス管理機能
**ユーザーストーリー:** ユーザーとして、問い合わせの送信履歴とステータスを確認したい。これにより、フォローアップや再送信の判断ができる。

#### 受け入れ条件
1. WHEN 問い合わせが送信される THEN 日時、企業名、使用テンプレート、送信内容が記録される
2. WHEN ユーザーが履歴を表示する THEN 送信成功、送信失敗、保留中などのステータスでフィルタリングできる
3. IF 送信確認メールが設定されている THEN 受信確認のステータスも記録する
4. WHEN エクスポート機能を使用する THEN CSV形式で履歴データをダウンロードできる
5. WHEN 特定の送信履歴を選択する THEN 詳細な送信内容とレスポンスを確認できる

### 要件6: バッチ処理・スケジューリング機能
**ユーザーストーリー:** ユーザーとして、複数の企業への問い合わせを一括で実行したい。また、時間を指定して送信したい。これにより、効率的な問い合わせ活動ができる。

#### 受け入れ条件
1. WHEN ユーザーが複数企業を選択する THEN 一括送信のキューに追加できる
2. WHEN バッチ処理を実行する THEN 各企業への送信間隔を設定できる（スパム対策）
3. IF 送信スケジュールを設定する THEN 指定した日時に自動的に送信処理が開始される
4. WHEN バッチ処理中にエラーが発生する THEN 処理を継続し、エラーログを記録する
5. WHEN 処理が完了する THEN サマリーレポートがメールまたは画面で確認できる

### 要件7: セキュリティ・コンプライアンス機能
**ユーザーストーリー:** ユーザーとして、送信先企業の利用規約に違反しない形で、安全に問い合わせを送信したい。これにより、法的リスクを回避できる。

#### 受け入れ条件
1. WHEN システムがウェブサイトにアクセスする THEN robots.txtを確認し、アクセス制限を遵守する
2. WHEN 送信頻度が高い場合 THEN 自動的に送信間隔を調整し、サーバー負荷を軽減する
3. IF 利用規約で自動送信が禁止されている場合 THEN 警告を表示し、送信を中止する
4. WHEN 個人情報を扱う THEN SSL/TLS通信を使用し、データを暗号化して保存する
5. WHEN ユーザーアカウントを作成する THEN 二要素認証オプションを提供する